<!DOCTYPE html>
<html>
<head>
    <title>OpenRemote Manager</title>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="icon" type="image/png" href="/static/img/favicon.png"/>

    <script src="/static/node_modules/@webcomponents/webcomponentsjs/webcomponents-lite.js"></script>

    <link rel="import" href="/static/src/or-app/or-app.html">
    <link rel="import" href="/static/src/manager/or-manager-console-apps/or-manager-console-apps-view.html">

    <script>
        window.addEventListener("AppReady", function (e) {
            console.log("Loading Manager resources...");

            let app = e.detail.app;

            Promise.all([
                app.load.css("/shared/map/mapbox-gl-js/1.2.1/mapbox-gl.css"),
                app.load.js("/shared/map/mapbox-gl-js/1.2.1/mapbox-gl.js"),

                app.load.js("/static/node_modules/chart.js/dist/Chart.js"),

                app.load.js("/shared/sprintf/1.0.3/sprintf.min.js")
            ]).then(() => {
                dispatchEvent(new CustomEvent("StartManager"));
            }).catch(e => {
                app.set("error", e);
            });
        });

        window.transformMapRequest = function(security) {
            return (url, resourceType) => {
                return {
                    url: url,
                    headers: {Authorization: security.getAuthHeader()}
                }
            };
        };
    </script>

    <style type="text/css">

        html, body {
            margin: 0;
            height: 100vh;
            overflow: hidden;
        }

        *:focus {
            outline: 0;
        }

        ::-webkit-scrollbar {
            width: 1em;
        }
        ::-webkit-scrollbar-track {
            background-color: var(--theme-black);
        }

        ::-webkit-scrollbar-thumb {
            background-color: var(--theme-lightgreen);
        }
    </style>

</head>

<body class="layout vertical">

<or-app login="true" console-name="Manager" console-version="1.0"></or-app>

<iframe src="javascript:''"
        id="__gwt_historyFrame"
        style="position:absolute;width:0;height:0;border:0"></iframe>

<noscript>
    <div style="border: 1px solid red;">
        Your web browser must have JavaScript enabled
        in order for this application to display correctly.
    </div>
</noscript>

</body>
</html>